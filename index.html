<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Banana Fields Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <style>
    body { margin:0; padding:0; }
    #map { width: 100%; height: 100vh; }
    .legend { background: white; padding: 10px; line-height: 18px; }
    .legend-color { display:inline-block; width:20px; height:20px; margin-right:5px; border:1px solid #000; vertical-align:middle; }
    .legend-item { cursor:pointer; }
  </style>
</head>
<body>
  <div id="map"></div>

  <script>
    var map = L.map('map').setView([33.9, 35.5], 8);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    // Colors for Class0 to Class6
    var classColors = {
      "0": "#1f77b4",
      "1": "#ff7f0e",
      "2": "#2ca02c",
      "3": "#d62728",
      "4": "#9467bd",
      "5": "#8c564b",
      "6": "#e377c2"
    };

    function style(feature) {
      return {
        color: classColors[feature.properties.Class] || "#999999",
        weight: 2,
        fillOpacity: 0.5
      };
    }

    function onEachFeature(feature, layer) {
      var popupContent = "<table>";
      for(var key in feature.properties){
        popupContent += "<tr><th>"+key+"</th><td>"+feature.properties[key]+"</td></tr>";
      }
      popupContent += "</table>";
      layer.bindPopup(popupContent);
    }

    // Load GeoJSON
    fetch("https://raw.githubusercontent.com/mariah-s25/Leaflet-Map/main/Banana_Fields.geojson")
      .then(response => response.json())
      .then(data => {
        // Create a layer group per class
        var classLayers = {};
        Object.keys(classColors).forEach(cls => { classLayers[cls] = L.layerGroup().addTo(map); });

        // Add features to corresponding class layer
        L.geoJSON(data, {
          style: style,
          onEachFeature: function(feature, layer) {
            onEachFeature(feature, layer);
            var cls = feature.properties.Class;
            if(classLayers[cls]) classLayers[cls].addLayer(layer);
          }
        });

        // Create legend with checkboxes
        var legend = L.control({position: 'topright'});
        legend.onAdd = function(map) {
          var div = L.DomUtil.create('div', 'legend');
          Object.keys(classColors).forEach(function(cls) {
            var color = classColors[cls];
            var container = L.DomUtil.create('div', 'legend-item', div);
            container.innerHTML = '<input type="checkbox" checked id="'+cls+'"> <span class="legend-color" style="background:'+color+'"></span> ' + cls;
            container.firstChild.onchange = function(e) {
              if(this.checked) map.addLayer(classLayers[cls]);
              else map.removeLayer(classLayers[cls]);
            };
          });
          return div;
        };
        legend.addTo(map);
      })
      .catch(err => console.error("Failed to load GeoJSON:", err));

  </script>
</body>
</html>
